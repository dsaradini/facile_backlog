{% extends "base.html" %}
{% load staticfiles sekizai_tags %}

{% block title %}{% trans "Project List" %}{% endblock %}

{% block content %}
	<div class="path">
		<i class="icon-home"></i><span class="current">{% trans "Home" %}</span>
	</div>


	<div class="left">
		<h1>{% trans "My projects" %}</h1>

		<div class="actions">
			<a class="button" href="{% url "project_create" %}">
				{% trans "Create new project" %}
			</a>
		</div>
		{% if object_list %}
		<form class="search" method="get" action="{% url "project_list" %}">
			<input type="test" name="q" placeholder="{% trans "Find a project..."%}" value="{{ query }}">
			<button class="alt-button" type="submit"><i class="icon-search"></i></button>
			{% if query %}
					<a class="alt-button" href=".">{% trans "Reset filter" %}</a>
			{% endif %}
		</form>

		<ul class="project-list">
			{% for object in object_list %}
				<li>
					<div class="title">
						<a href="{% url 'project_detail' object.pk %}"><i class="icon-book black"></i> {{ object.name }}</a>
					</div>
					<div class="stats">
						<div class="story-stats percent-cell">
							<div class="name">
								<i class="icon-list-alt info"></i> <b>{{ object.stats.total_stories }}</b> </span><a href="{% url "project_stories" object.pk %}" class="info">{% trans "Stories" %} </a>
								&nbsp;
								<i class="icon-circle info"></i> <b>{{ object.stats.total_points }}</b> </span><a href="{% url "project_stories" object.pk %}" class="info">{% trans "Points" %} </a>
							</div>
							{% if object.stats.estimated_stories %}
								<span class="percent bg-blue" style="width:{{ object.stats.percent_estimated }}%">{{ object.stats.estimated_stories }} <i class="icon-circle info"></i> {{ object.stats.estimated_points }}</span>
							{% else %}
								<span class="percent" style="width:0"></span>
							{% endif %}
							{% if object.stats.completed_stories %}
								<span class="percent bg-green" style="width:{{ object.stats.percent_completed }}%">{{ object.stats.completed_stories }} <i class="icon-circle info"></i> {{ object.stats.completed_points }}</span>
							{% else %}
								<span class="percent" style="width:0"></span>
							{% endif %}
						</div>
						<div class="story-stats percent-cell">
							<div class="name">
								<p>
									<i class="icon-list-ul info"></i> <b>{{ object.stats.backlog_count }}</b> </span><a href="{% url "project_detail" object.pk %}" class="info">{% trans "Backlogs" %} </a>
								</p>
								<p>
									<i class="icon-user info"></i> <b>{{ object.stats.user_count }}</b> </span><a href="{% url "project_users" object.pk %}" class="info">{% trans "Team members" %} </a>
								</p>
							</div>
						</div>
					</div>
				</li>
			{% endfor %}
			{% if is_paginated and page_obj.has_next %}
				<li>
					<span class="info"> <a href="?page={{ page_obj.next_page_number }}">{% trans "More project available..." %}</a> </span>
				</li>
			{% endif %}
		</ul>
		{%  else %}
			<ul class="project-list">
				{% trans "No active project found" %}
			</ul>
		{% endif %}
	</div>
	<div class="right">
		<h1>{% trans "My activities" %}</h1>
		<div class="actions"></div>
		{% include "backlog/_events.html" with events=events gravatar=True%}
	</div>
{% endblock %}