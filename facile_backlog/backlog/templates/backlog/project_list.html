{% extends "project_base.html" %}
{% load staticfiles sekizai_tags %}

{% block title %}{% trans "Project List" %}{% endblock %}

{% block content %}
<ul class="breadcrumb">
	<li class="active"><i class="icon-home"></i>{% trans "Projects" %}<span class="divider">/</span></li>
</ul>

<div class="row">
	<div class="span6">
		<div class="row-fluid">
			<form  method="get" action="{% url "project_list" %}">
				<div class="span10 input-append input-prepend">
					<input class="span8" type="text" name="q" placeholder="{% trans "Find a project..."%}" value="{{ query }}">
					{% if query %}
						<a class="btn add-on" href="."><i class="icon-remove"></i></a>
					{% endif %}
					<button class="btn" type="submit"><i class="icon-search"></i></button>
				</div>
			</form>
			<div style="text-align:center">
				<a class="btn btn-primary" href="{% url "project_create" %}">
					{% trans "Create project" %}
				</a>
			</div>
		</div>
		<hr>
		{% if object_list%}
		<ul class="project-list">
			{% for object in object_list %}
				<li>
					<div class="title">
						<a href="{% url 'project_detail' object.pk %}"><i class="icon-book black"></i> {{ object.name }}</a>
					</div>
					<div class="stats">
						<div class="story-stats percent-cell">
							<div class="name">
								<i class="icon-list-alt info"></i> <b>{{ object.stats.total_stories }}</b> </span><a href="{% url "project_stories" object.pk %}" class="info">{% trans "Stories" %} </a>
								&nbsp;
								<i class="icon-circle info"></i> <b>{{ object.stats.total_points }}</b> </span><a href="{% url "project_stories" object.pk %}" class="info">{% trans "Points" %} </a>
							</div>
							{% if object.stats.estimated_stories %}
								<span class="percent bg-blue" style="width:{{ object.stats.percent_estimated }}%">{{ object.stats.estimated_stories }} <i class="icon-circle info"></i> {{ object.stats.estimated_points }}</span>
							{% else %}
								<span class="percent" style="width:0"></span>
							{% endif %}
							{% if object.stats.completed_stories %}
								<span class="percent bg-green" style="width:{{ object.stats.percent_completed }}%">{{ object.stats.completed_stories }} <i class="icon-circle info"></i> {{ object.stats.completed_points }}</span>
							{% else %}
								<span class="percent" style="width:0"></span>
							{% endif %}
						</div>
						<div class="story-stats percent-cell">
							<div class="name">
								<p>
									<i class="icon-list-ul info"></i> <b>{{ object.stats.backlog_count }}</b> </span><a href="{% url "project_backlogs" object.pk %}" class="info">{% trans "Backlogs" %} </a>
								</p>
								<p>
									<i class="icon-user info"></i> <b>{{ object.stats.user_count }}</b> </span><a href="{% url "project_users" object.pk %}" class="info">{% trans "Team members" %} </a>
								</p>
							</div>
						</div>
					</div>
				</li>
			{% endfor %}
			{% if is_paginated and page_obj.has_next %}
				<li>
					<div class="alert alert-info text-center"> <a href="?page={{ page_obj.next_page_number }}&q={{ query }}">{% trans "More project available..." %}</a> </div>
				</li>
			{% endif %}
		</ul>
		{%  else %}
		<div class="alert alert-info">
			{% if not query %}
				{% trans "You have no active project found" %}
			{% else %}
				{% trans "No project found" %}
			{% endif %}
		</div>
		{% endif %}
	</div>
	<div class="span6">
		<h3>{% trans "My activities" %}</h3>
		<div class="actions"></div>
		{% include "backlog/_events.html" with events=events gravatar=True%}
	</div>
<div>
{% endblock %}