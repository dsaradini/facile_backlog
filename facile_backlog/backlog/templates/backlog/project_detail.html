{% extends "base.html" %}
{% load staticfiles sekizai_tags markup acl %}

{% block title %}{% trans "Project" %} &mdash; {{ project.name }}{% endblock %}
{% block content %}
	<div class="path">
		<a href="{%  url "home" %}"><i class="icon-home"></i>{% trans "Home" %}</a> /
		<i class="icon-book"></i> <span class="current">{{ project.name }}</span>
	</div>
	<div id="links">
		<span class="tab active">{% trans "Backlogs" %}</span>
		<span class="tab">
			<a href="{% url "project_users" project.pk %}">{% trans "Users" %} </a>
		</span>
	</div>
	<h1>{{ project.name }}</h1>
	<div class="actions">
		{% if project|can_admin:request.user %}
			<a class="alt-button" href="{% url "project_edit" project.pk %}">
				{% trans "Edit project" %}
			</a>
			<a class="alt-button" href="{% url "project_delete" project.pk %}">
				{% trans "Delete project" %}
			</a>
		{% endif %}
	</div>
	<div class="description">
		{% if project.description %}
			{{ project.description|markdown }}
		{% endif %}
	</div>

	<h2>{% trans "Backlogs" %}</h2>
	<div class="actions">
		{% if project|can_admin:request.user %}
			<a class="button" href="{% url "backlog_create" project.pk %}">
				<i class="icon-magic"></i>
				{% trans "Create backlog" %}
			</a>
		{% endif %}
	</div>
	<div class="backlog-list">
		<ul>
			{% for backlog in project.backlogs.all %}
				<li>
					<i class="icon-list-alt"></i>
					<a href="{% url 'backlog_detail' project.pk backlog.pk %}">{{ backlog.name }}</a>
					<span class="story-count">
						{% with backlog.stories.count as counter %}
							{% if counter %}
								{% blocktrans count counter as counter %}
									one story
								{% plural %}
									{{ counter }} stories
								{% endblocktrans %}
							{% else %}
								{% trans "No story" %}
							{% endif %}
						{% endwith %}
					</span>
				</li>
			{% empty %}
				{% trans "No backlog" %}
			{% endfor %}
		</ul>
	</div>

{% endblock %}